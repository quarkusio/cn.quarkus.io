# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR Free Software Foundation, Inc.
# This file is distributed under the same license as the PACKAGE package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 2022-05-12 15:52+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: zh_CN\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. type: YAML Front Matter: title
#: _posts/2020-10-13-uni-retry.adoc
#, fuzzy, no-wrap
msgid "Mutiny - How does retry... retries?"
msgstr "叛变--重试......如何重试？"

#. type: YAML Front Matter: synopsis
#: _posts/2020-10-13-uni-retry.adoc
#, fuzzy, no-wrap
msgid "How does `retry` actually work?"
msgstr " `retry` 实际上是如何工作的？"

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"Last week, David, a Quarkus user, asked me about retrying an asynchronous operation.\n"
"David has a _picky_ remote HTTP service, which sometimes misbehaves.\n"
"Easy answer!\n"
"Just do: `uni.onFailure().retry().atMost(x)`.\n"
"But, David is curious, and asked me a second question: how does retry work?\n"
"Well, that’s simple; it just retries...\n"
"As you can imagine, that did not satisfy David’s curiosity."
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"While I was answering to David, I realized that retrying is not that simple and deserves more explanation.\n"
"That’s what we are going to see in this blog post."
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid "Disclaimer about retries"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"Okay, if you are the kind of reader who skips the terms and conditions, you can jump to the next section.\n"
"But, for others, I need to warn you about retries.\n"
"Retries may not be the solution to your problem, as it can be terrible.\n"
"Retrying can only be done if your system can handle duplicated requests or messages.\n"
"In other words, you can only retry if your system is idempotent, i.e., sending a request or a message multiple times does not change the overall state.\n"
"In doubt, check before implementing a retry, as it can harm your system."
msgstr ""

#. type: Plain text
#: _posts/2020-10-13-uni-retry.adoc
#, fuzzy
msgid "Disclaimer said! Let’s look under the hood of retry."
msgstr "免责声明说!让我们来看看重试的引擎盖下。"

#: _posts/2020-10-13-uni-retry.adoc
msgid "Retry is about resubscribing"
msgstr ""

#. type: Plain text
#: _posts/2020-10-13-uni-retry.adoc
#, fuzzy
msgid "Let’s imagine you have a `Uni` representing your asynchronous action, like in David’s case, an invocation of a remote service:"
msgstr "让我们想象一下，你有一个 `Uni` ，代表你的异步操作，比如在David的案例中，是对一个远程服务的调用。"

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"Unis are lazy.\n"
"Until someone subscribes to them, nothing happens.\n"
"In our case, the request is only sent to the remote service when someone subscribes to the `uni`.\n"
"So to execute the request, we need to subscribe:"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"In Quarkus, most of the time, you return the `Uni`, and Quarkus subscribes to it.\n"
"So, don't be mistaken, there is a subscription, you may not see it."
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"This laziness is the retry secret.\n"
"In the following sequence diagram, you can see that the request is sent when we get a subscriber:"
msgstr ""

#. type: Plain text
#: _posts/2020-10-13-uni-retry.adoc
#, fuzzy
msgid "image:/assets/images/posts/mutiny-retry/subscription.png[]"
msgstr "image:/assets/images/posts/mutiny-retry/subscription.png[alt=\"subscription\"]"

#. type: Plain text
#: _posts/2020-10-13-uni-retry.adoc
#, fuzzy
msgid "An interesting consequence of this is that if you subscribe twice, you emit two requests, and so get two responses:"
msgstr "一个有趣的结果是，如果你订阅了两次，你就会发出两个请求，因此得到两个回应。"

#. type: Plain text
#: _posts/2020-10-13-uni-retry.adoc
#, fuzzy
msgid "image:/assets/images/posts/mutiny-retry/double-subscription.png[]"
msgstr "image:/assets/images/posts/mutiny-retry/double-subscription.png[alt=\"double subscription\"]"

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"But let’s go back to retry.\n"
"What’s a retry?\n"
"A retry is a reaction to a failure, so you are going to write: `uni.onFailure().retry()`.\n"
"You also need to indicate how long do you want to retry:"
msgstr ""

#. type: Plain text
#: _posts/2020-10-13-uni-retry.adoc
#, fuzzy
msgid "In this snippet, we retry _indefinitely_ until we get a successful result."
msgstr "在这个片段中，我们 _无限期_ 地重试，直到得到一个成功的结果。"

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"But, how does it work under the hood?\n"
"It’s quite simple.\n"
"If it gets a failure, it just re-subscribes:"
msgstr ""

#. type: Plain text
#: _posts/2020-10-13-uni-retry.adoc
#, fuzzy
msgid "image:/assets/images/posts/mutiny-retry/retry.png[]"
msgstr "image:/assets/images/posts/mutiny-retry/retry.png[alt=\"retry\"]"

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"It resubscribes until it gets a successful response.\n"
"In other words, retrying is resubscribing."
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid "How many times should I retry?"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"That’s always a good question.\n"
"Should I retry _indefinitely_?\n"
"Most probably, not.\n"
"Indefinitely can be very long, and it could never end if the called service fails continuously."
msgstr ""

#. type: Plain text
#: _posts/2020-10-13-uni-retry.adoc
#, fuzzy
msgid "You can configure the number of retries using `atMost`:"
msgstr "你可以使用 `atMost` ，配置重试的次数。"

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"`atMost` indicates that at most `n` attempts will be done before failing.\n"
"If we still get a failure after that number of resubscription, the last failure is sent to the subscriber."
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid "image:/assets/images/posts/mutiny-retry/retry-failed.png[]"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid "You can also use `until` and decide to retry by looking at the received failure:"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid "Bonus: Exponential backoff"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"So far, our retries happen immediately.\n"
"It might not be very wise, and separating a bit our retries may give better results, especially when facing intermittent failures due to the load or other external causes.\n"
"Using exponential backoff provides a reasonable tradeoff.\n"
"Retrying with exponential backoff:"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid "retries after an initial delay,"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid "on every failure, it doubles the previous delay, with an optional maximum,"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid "it can use a jitter to add a random duration to the delay,"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid "it can have a max delay if needed,"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid "it is still constrained by `atMost`"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"This last snippet configures the retry with exponential backoff.\n"
"The first retry happens after 1 second, and then it doubles every time without an upper limit.\n"
"Random jitter is applied to delays.\n"
"If, unfortunately, after ten attempts, it still fails, the failure is sent to the subscriber."
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid "Demo time!"
msgstr ""

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"Ok, enough talking.\n"
"I’ve built a simple playground where you can adjust and try the various retry policies: https://gist.github.com/cescoffier/e9abce907a1c3d05d70bea3dae6dc3d5.\n"
"You can _jbang_ the script by downloading it and running `jbang Retry.java`, or just run:"
msgstr ""

#. type: Plain text
#: _posts/2020-10-13-uni-retry.adoc
#, fuzzy
msgid "The called service fails 50% of the time (well, it uses a random, so statistically 50% of the time)."
msgstr "被调用的服务有50%的时间是失败的（好吧，它使用的是随机的，所以统计上有50%的时间）。"

#: _posts/2020-10-13-uni-retry.adoc
msgid ""
"That concludes this blog post.\n"
"Again, before using retry, please verify that your system can support it.\n"
"Retrying is resubscribing.\n"
"You can configure how long, how many times, and when retrying should be attempted.\n"
"There are many more options offered by Mutiny, like `when` or using deadlines (`expireIn` and `expireAt`) when using exponential backoff.\n"
"You can try all these with the provided playground."
msgstr ""

#. type: Plain text
#: _posts/2020-10-13-uni-retry.adoc
msgid "Stay tuned! We have plenty of other gems to discuss here!"
msgstr ""
